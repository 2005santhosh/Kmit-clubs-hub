<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - KMIT Clubs Hub</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables */
        :root {
            --primary: #003366;
            --primary-dark: #002244;
            --secondary: #f8fafc;
            --accent: #ffc107;
            --accent-light: #ffcd39;
            --text: #212529;
            --light-text: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --section-padding: 100px 0;
            --container-padding: 0 20px;
            --gradient-primary: linear-gradient(135deg, #003366 0%, #0055a4 100%);
            --gradient-accent: linear-gradient(135deg, #ffc107 0%, #ffcd39 100%);
        }

        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            line-height: 1.7;
            color: var(--text);
            background-color: #fff;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--container-padding);
        }

        /* Typography */
        h1, h2, h3, h4 {
            font-family: 'Poppins', sans-serif;
            margin-bottom: 1.2rem;
            font-weight: 600;
            line-height: 1.2;
        }

        h1 {
            font-size: 2.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            position: relative;
        }

        h3 {
            font-size: 1.5rem;
            margin-bottom: 0.8rem;
            color: var(--primary);
        }

        p {
            margin-bottom: 1.2rem;
            color: var(--light-text);
            font-weight: 300;
        }

        a {
            text-decoration: none;
            color: var(--primary);
            transition: var(--transition);
        }

        a:hover {
            color: var(--accent);
        }

        /* Dashboard Layout */
        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--gradient-primary);
            color: white;
            padding: 2rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: var(--transition);
        }

        .sidebar-header {
            padding: 0 1.5rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }

        .sidebar-header h2 {
            color: white;
            font-size: 1.5rem;
            background: none;
            -webkit-text-fill-color: initial;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 0.5rem;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 0.8rem 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            transition: var(--transition);
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .sidebar-menu i {
            margin-right: 0.8rem;
            font-size: 1.2rem;
        }

        .user-profile {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-weight: 600;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-info h4 {
            color: white;
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .user-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            margin: 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
            background-color: #f8fafc;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .dashboard-title h1 {
            margin-bottom: 0.5rem;
        }

        .dashboard-actions {
            display: flex;
            gap: 1rem;
        }

        .notification-icon {
            position: relative;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--accent);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Content Sections */
        .content-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.3rem;
            color: var(--primary);
            margin: 0;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 51, 102, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 51, 102, 0.4);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }

        .btn-warning {
            background-color: #ffc107;
            color: var(--primary-dark);
        }

        .btn-warning:hover {
            background-color: #e0a800;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
            transform: translateY(-2px);
        }

        /* Settings Tabs */
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid #e9ecef;
            margin-bottom: 1.5rem;
        }

        .settings-tab {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            color: var(--light-text);
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .settings-tab:hover {
            color: var(--primary);
        }

        .settings-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Settings Forms */
        .settings-form {
            display: none;
        }

        .settings-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 51, 102, 0.1);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-col {
            flex: 1;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* Password field with toggle */
        .password-field {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--light-text);
            background: none;
            border: none;
            font-size: 1rem;
        }

        .password-toggle:hover {
            color: var(--primary);
        }

        /* Profile Section */
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 2rem;
            font-size: 2.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-info h2 {
            margin-bottom: 0.5rem;
        }

        .profile-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .profile-meta-item {
            display: flex;
            align-items: center;
        }

        .profile-meta-item i {
            margin-right: 0.5rem;
            color: var(--accent);
        }

        /* Legal Documents */
        .legal-docs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .legal-doc-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
            border-left: 4px solid var(--primary);
        }

        .legal-doc-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow);
        }

        .legal-doc-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .legal-doc-icon {
            font-size: 1.5rem;
            color: var(--primary);
            margin-right: 1rem;
        }

        .legal-doc-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .legal-doc-description {
            margin-bottom: 1rem;
            color: var(--light-text);
        }

        .legal-doc-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1001;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: var(--box-shadow);
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--light-text);
            cursor: pointer;
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Alert message styles */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-avatar {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            
            .profile-meta {
                justify-content: center;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .legal-docs {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-university"></i> KMIT Clubs Hub</h2>
            </div>
            <ul class="sidebar-menu">
                <li><a href="admin.html"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="user-management.html"><i class="fas fa-users"></i> User Management</a></li>
                <li><a href="role-management.html"><i class="fas fa-user-shield"></i> Role Management</a></li>
                <li><a href="club-management.html"><i class="fas fa-users-cog"></i> Club Management</a></li>
                <li><a href="event-management.html"><i class="fas fa-calendar-alt"></i> Event Management</a></li>
                <li><a href="reports.html"><i class="fas fa-file-alt"></i> Reports</a></li>
                <li><a href="analytics.html"><i class="fas fa-chart-line"></i> Analytics</a></li>
                <li><a href="system-settings.html" class="active"><i class="fas fa-cog"></i>System Settings</a></li>
            </ul>
            <div class="user-profile">
                <div class="user-avatar" id="userAvatar">SA</div>
                <div class="user-info">
                    <h4 id="userName">Loading...</h4>
                    <p id="userRole">System Administrator</p>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="dashboard-title">
                    <h1>Settings</h1>
                    <p>Manage your profile and account settings.</p>
                </div>
                <div class="dashboard-actions">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationCount">0</span>
                    </div>
                    <button class="btn btn-secondary" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>

            <!-- Settings Tabs -->
            <div class="content-section">
                <div class="settings-tabs">
                    <div class="settings-tab active" data-tab="profile">Profile</div>
                    <div class="settings-tab" data-tab="account">Account</div>
                    <div class="settings-tab" data-tab="legal">Legal</div>
                </div>

                <!-- Profile Settings -->
                <div class="settings-form active" id="profile-settings">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">
                            <span id="profileAvatarText">Loading...</span>
                        </div>
                        <div class="profile-info">
                            <h2 id="profileName">Loading...</h2>
                            <div class="profile-meta">
                                <div class="profile-meta-item">
                                    <i class="fas fa-user-tag"></i>
                                    <span id="profileRole">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Account Settings -->
                <div class="settings-form" id="account-settings">
                    <div id="passwordAlert"></div>
                    <form id="accountSettingsForm">
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <div class="password-field">
                                <input type="password" id="currentPassword" class="form-control" required>
                                <button type="button" class="password-toggle" data-target="currentPassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="newPassword">New Password</label>
                                    <div class="password-field">
                                        <input type="password" id="newPassword" class="form-control" required>
                                        <button type="button" class="password-toggle" data-target="newPassword">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="confirmPassword">Confirm New Password</label>
                                    <div class="password-field">
                                        <input type="password" id="confirmPassword" class="form-control" required>
                                        <button type="button" class="password-toggle" data-target="confirmPassword">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelPasswordChange">Cancel</button>
                            <button type="submit" class="btn btn-primary">Update Password</button>
                        </div>
                    </form>
                </div>

                <!-- Legal Settings -->
                <div class="settings-form" id="legal-settings">
                    <h3 class="section-title">Legal Documents</h3>
                    <div class="legal-docs">
                        <div class="legal-doc-card">
                            <div class="legal-doc-header">
                                <div class="legal-doc-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="legal-doc-title">Privacy Policy</div>
                            </div>
                            <div class="legal-doc-description">
                                Learn how we collect, use, and protect your personal information.
                            </div>
                            <div class="legal-doc-actions">
                                <button class="btn btn-primary view-privacy-policy">View Policy</button>
                            </div>
                        </div>
                        <div class="legal-doc-card">
                            <div class="legal-doc-header">
                                <div class="legal-doc-icon">
                                    <i class="fas fa-file-contract"></i>
                                </div>
                                <div class="legal-doc-title">Terms and Conditions</div>
                            </div>
                            <div class="legal-doc-description">
                                Read the terms and conditions that govern your use of our platform.
                            </div>
                            <div class="legal-doc-actions">
                                <button class="btn btn-primary view-terms">View Terms</button>
                            </div>
                        </div>
                        <div class="legal-doc-card">
                            <div class="legal-doc-header">
                                <div class="legal-doc-icon">
                                    <i class="fas fa-cookie-bite"></i>
                                </div>
                                <div class="legal-doc-title">Cookie Policy</div>
                            </div>
                            <div class="legal-doc-description">
                                Understand how we use cookies and similar technologies on our platform.
                            </div>
                            <div class="legal-doc-actions">
                                <button class="btn btn-primary view-cookie-policy">View Policy</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyPolicyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Privacy Policy</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <h4>Information We Collect</h4>
                <p>We collect information you provide directly to us, such as when you create an account, update your profile, or contact us for support.</p>
                
                <h4>How We Use Your Information</h4>
                <p>We use the information we collect to provide, maintain, and improve our services, process transactions, send notifications, and respond to your inquiries.</p>
                
                <h4>Information Sharing</h4>
                <p>We do not sell, trade, or otherwise transfer your personal information to third parties without your consent, except as described in this Privacy Policy.</p>
                
                <h4>Data Security</h4>
                <p>We implement appropriate technical and organizational measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction.</p>
                
                <h4>Your Rights</h4>
                <p>You have the right to access, update, or delete your personal information at any time through your account settings.</p>
                
                <h4>Changes to This Policy</h4>
                <p>We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Terms and Conditions Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Terms and Conditions</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <h4>Acceptance of Terms</h4>
                <p>By accessing and using the KMIT Clubs Hub platform, you accept and agree to be bound by the terms and provision of this agreement.</p>
                
                <h4>Use License</h4>
                <p>Permission is granted to temporarily download one copy of the materials on KMIT Clubs Hub for personal, non-commercial transitory viewing only.</p>
                
                <h4>Disclaimer</h4>
                <p>The materials on KMIT Clubs Hub are provided on an 'as is' basis. KMIT Clubs Hub makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.</p>
                
                <h4>Limitations</h4>
                <p>In no event shall KMIT Clubs Hub or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on KMIT Clubs Hub.</p>
                
                <h4>Accuracy of Materials</h4>
                <p>The materials appearing on KMIT Clubs Hub could include technical, typographical, or photographic errors. KMIT Clubs Hub does not warrant that any of the materials on its website are accurate, complete, or current.</p>
                
                <h4>Modifications</h4>
                <p>KMIT Clubs Hub may revise these terms of service for its website at any time without notice. By using this website you are agreeing to be bound by the then current version of these terms of service.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Cookie Policy Modal -->
    <div id="cookiePolicyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Cookie Policy</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <h4>What Are Cookies</h4>
                <p>Cookies are small text files that are placed on your computer or mobile device when you visit a website. They are widely used by website owners in order to make their websites work, or work more efficiently, as well as to provide reporting information.</p>
                
                <h4>How We Use Cookies</h4>
                <p>We use cookies to personalize content and ads, to provide social media features and to analyze our traffic. We also share information about your use of our site with our social media, advertising and analytics partners who may combine it with other information that you've provided to them or that they've collected from your use of their services.</p>
                
                <h4>Types of Cookies We Use</h4>
                <p><strong>Essential Cookies:</strong> These cookies are necessary for the website to function and cannot be switched off in our systems.</p>
                <p><strong>Performance Cookies:</strong> These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site.</p>
                <p><strong>Functional Cookies:</strong> These cookies enable the website to provide enhanced functionality and personalization.</p>
                <p><strong>Targeting Cookies:</strong> These cookies may be set through our site by our advertising partners to build a profile of your interests.</p>
                
                <h4>Managing Cookies</h4>
                <p>You can set your browser not to accept cookies, and the above website tells you how to remove cookies from your browser. However, in a few cases, some of our website features may not function as a result.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">Close</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            
            if (!token) {
                window.location.href = '/login';
                return;
            }
            
            // Update user profile in sidebar
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            const userRole = document.getElementById('userRole');
            
            // Set user initials for avatar
            if (user.name) {
                const initials = user.name.split(' ').map(n => n[0]).join('').toUpperCase();
                userAvatar.textContent = initials;
                userName.textContent = user.name;
            }
            
            // Set user role
            if (user.role) {
                userRole.textContent = user.role === 'admin' ? 'System Administrator' : 
                                         user.role === 'faculty' ? 'Faculty Coordinator' :
                                         user.role === 'clubLeader' ? 'Club Leader' : 'Student';
            }
            
            // Mobile menu toggle
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.getElementById('sidebar');
            
            mobileMenuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
            });
            
            // Close sidebar when clicking on a link
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.addEventListener('click', () => {
                    sidebar.classList.remove('active');
                });
            });
            
            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', function() {
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                window.location.href = '/login';
            });
            
            // Settings tabs
            const settingsTabs = document.querySelectorAll('.settings-tab');
            const settingsForms = document.querySelectorAll('.settings-form');
            
            settingsTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    settingsTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active form
                    settingsForms.forEach(form => {
                        form.classList.remove('active');
                        if (form.id === `${tabId}-settings`) {
                            form.classList.add('active');
                        }
                    });
                });
            });
            
            // Password visibility toggle
            document.querySelectorAll('.password-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const passwordInput = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        passwordInput.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });
            
            // Fetch user profile data
            async function fetchUserProfile() {
                try {
                    const response = await fetch('/api/users/profile', {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`Failed to fetch user profile: ${response.status}`);
                    }
                    
                    const userProfile = await response.json();
                    
                    // Update profile display
                    document.getElementById('profileName').textContent = userProfile.name || 'Unknown';
                    document.getElementById('profileRole').textContent = userProfile.role === 'admin' ? 'System Administrator' : 
                                                              userProfile.role === 'faculty' ? 'Faculty Coordinator' :
                                                              userProfile.role === 'clubLeader' ? 'Club Leader' : 'Student';
                    
                    // Update profile avatar
                    const profileAvatarText = document.getElementById('profileAvatarText');
                    if (userProfile.name) {
                        const initials = userProfile.name.split(' ').map(n => n[0]).join('').toUpperCase();
                        profileAvatarText.textContent = initials;
                    }
                    
                    // If user has an avatar image, display it
                    if (userProfile.avatar) {
                        const profileAvatar = document.getElementById('profileAvatar');
                        profileAvatar.innerHTML = `<img src="${userProfile.avatar}" alt="Profile Avatar">`;
                    }
                } catch (error) {
                    console.error('Error fetching user profile:', error);
                    // Show error message in profile section
                    document.getElementById('profileName').textContent = 'Error loading profile';
                    document.getElementById('profileRole').textContent = 'Please try again later';
                }
            }
            
            // Account settings form submission
            document.getElementById('accountSettingsForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (newPassword !== confirmPassword) {
                    showAlert('New password and confirm password do not match.', 'danger');
                    return;
                }
                
                if (newPassword.length < 6) {
                    showAlert('Password must be at least 6 characters long.', 'danger');
                    return;
                }
                
                try {
                    const response = await fetch('/api/auth/change-password', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ 
                            currentPassword, 
                            newPassword 
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        showAlert('Password updated successfully!', 'success');
                        document.getElementById('accountSettingsForm').reset();
                    } else {
                        showAlert(data.message || 'Failed to update password. Please try again.', 'danger');
                    }
                } catch (error) {
                    console.error('Error updating password:', error);
                    showAlert('Error updating password. Please try again.', 'danger');
                }
            });
            
            // Cancel password change
            document.getElementById('cancelPasswordChange').addEventListener('click', function() {
                document.getElementById('accountSettingsForm').reset();
                document.getElementById('passwordAlert').innerHTML = '';
            });
            
            // Function to show alert messages
            function showAlert(message, type) {
                const alertDiv = document.getElementById('passwordAlert');
                alertDiv.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
                
                // Auto-hide success messages after 5 seconds
                if (type === 'success') {
                    setTimeout(() => {
                        alertDiv.innerHTML = '';
                    }, 5000);
                }
            }
            
            // Privacy Policy Modal
            const privacyPolicyModal = document.getElementById('privacyPolicyModal');
            const viewPrivacyPolicyBtn = document.querySelector('.view-privacy-policy');
            
            viewPrivacyPolicyBtn.addEventListener('click', function() {
                privacyPolicyModal.style.display = 'flex';
            });
            
            // Terms and Conditions Modal
            const termsModal = document.getElementById('termsModal');
            const viewTermsBtn = document.querySelector('.view-terms');
            
            viewTermsBtn.addEventListener('click', function() {
                termsModal.style.display = 'flex';
            });
            
            // Cookie Policy Modal
            const cookiePolicyModal = document.getElementById('cookiePolicyModal');
            const viewCookiePolicyBtn = document.querySelector('.view-cookie-policy');
            
            viewCookiePolicyBtn.addEventListener('click', function() {
                cookiePolicyModal.style.display = 'flex';
            });
            
            // Close modals
            document.querySelectorAll('.modal-close').forEach(button => {
                button.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
            
            // Initial data fetch
            fetchUserProfile();
        });
    </script>
</body>
</html>